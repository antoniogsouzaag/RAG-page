@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --font-sans: 'Inter', sans-serif;
  --font-display: 'Outfit', sans-serif;

  --color-background: hsl(240 10% 3.9%);
  --color-foreground: hsl(0 0% 98%);

  --color-card: hsl(240 10% 3.9%);
  --color-card-foreground: hsl(0 0% 98%);

  --color-popover: hsl(240 10% 3.9%);
  --color-popover-foreground: hsl(0 0% 98%);

  --color-primary: hsl(263 70% 50%);
  --color-primary-foreground: hsl(210 40% 98%);

  --color-secondary: hsl(240 3.7% 15.9%);
  --color-secondary-foreground: hsl(0 0% 98%);

  --color-muted: hsl(240 3.7% 15.9%);
  --color-muted-foreground: hsl(240 5% 64.9%);

  --color-accent: hsl(263 70% 50%);
  --color-accent-foreground: hsl(0 0% 98%);

  --color-destructive: hsl(0 62.8% 30.6%);
  --color-destructive-foreground: hsl(0 0% 98%);

  --color-border: hsl(240 3.7% 15.9%);
  --color-input: hsl(240 3.7% 15.9%);
  --color-ring: hsl(240 4.9% 83.9%);
  
  --radius-sm: 0.3rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
}

@layer utilities {
  /* Performance-optimized fade-in-up animation for Hero section - using cubic-bezier for smooth natural motion */
  @keyframes fade-in-up {
    0% {
      opacity: 0;
      transform: translate3d(0, 24px, 0);
    }
    100% {
      opacity: 1;
      transform: translate3d(0, 0, 0);
    }
  }
  
  .animate-fade-in-up {
    animation: fade-in-up 0.7s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    animation-fill-mode: forwards;
    transform: translateZ(0);
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }
  
  /* Stable animation states - applied after animation completes */
  .animation-complete {
    opacity: 1 !important;
    transform: translate3d(0, 0, 0) !important;
  }
  
  /* Performance optimizations for animations */
  .will-change-transform {
    will-change: transform;
  }
  
  .will-change-opacity {
    will-change: opacity;
  }
  
  /* GPU-accelerated rainbow button animation - smoother easing */
  .rainbow-btn {
    background: linear-gradient(90deg, #9333ea, #db2777, #7c3aed, #9333ea);
    background-size: 200% 100%;
    animation: rainbow 5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
    box-shadow: 0 4px 20px rgba(147, 51, 234, 0.4), 0 0 40px rgba(219, 39, 119, 0.2);
    transition: box-shadow 0.4s cubic-bezier(0.22, 1, 0.36, 1), transform 0.3s cubic-bezier(0.22, 1, 0.36, 1);
    will-change: background-position;
    contain: layout style paint;
    transform: translateZ(0); /* Force GPU layer */
  }

  .rainbow-btn:hover {
    box-shadow: 0 6px 30px rgba(147, 51, 234, 0.5), 0 0 60px rgba(219, 39, 119, 0.35);
  }

  @keyframes rainbow {
    0%, 100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  .glass {
    @apply bg-black/40 backdrop-blur-lg border border-white/10;
    contain: layout style;
  }
  
  .glass-card {
    @apply bg-zinc-900/60 backdrop-blur-md border border-white/5 hover:border-white/10 transition-colors duration-300;
    contain: layout style;
  }

  .text-glow {
    text-shadow: 0 0 20px rgba(124, 58, 237, 0.5);
  }

  /* Optimized noise background - uses content-visibility for performance */
  .bg-noise {
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 50;
    opacity: 0.35;
    contain: strict;
    content-visibility: auto;
  }

  /* Performance optimizations for mobile */
  @media (max-width: 768px) {
    .bg-noise {
      display: none;
    }
    
    /* CRITICAL: Force stable final animation state on mobile - prevents flicker */
    .animate-fade-in-up {
      animation: none !important;
      opacity: 1 !important;
      transform: none !important;
    }
    
    /* Disable framer-motion opacity transitions to prevent end-of-animation flicker */
    [style*="opacity"] {
      transition: opacity 0ms !important;
    }
    
    /* Reduce blur on mobile for better performance */
    .blur-3xl {
      filter: blur(24px);
    }
    
    .blur-\[100px\], .blur-\[120px\], .blur-\[150px\] {
      filter: blur(32px);
    }
    
    /* Reduce blur-[80px] as well */
    .blur-\[80px\] {
      filter: blur(24px);
    }
    
    /* Reduce blur-[60px] */
    .blur-\[60px\] {
      filter: blur(20px);
    }

    /* Mobile pillar background fallback (lightweight) */
    .mobile-pillar-bg {
      background: linear-gradient(180deg, rgba(48,24,96,0.25), rgba(219,39,119,0.18));
      filter: blur(18px);
      mix-blend-mode: screen;
      contain: strict;
    }

    /* Slow spin for lightweight SVG globe on mobile */
    @keyframes spin-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .animate-spin-slow {
      animation: spin-slow 12s linear infinite;
      transform: translateZ(0);
      -webkit-transform: translateZ(0);
    }

    /* Disable heavy animations on mobile */
    .animate-pulse {
      animation: none !important;
    }
    
    /* Disable ping animations on mobile */
    .animate-ping {
      animation: none !important;
      opacity: 0 !important;
    }

    /* Reduce backdrop blur on mobile for performance */
    .backdrop-blur-xl {
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
    }

    .backdrop-blur-md {
      backdrop-filter: blur(3px);
      -webkit-backdrop-filter: blur(3px);
    }

    .backdrop-blur-lg {
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
    }
    
    .backdrop-blur-2xl {
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    
    /* Disable expensive effects on mobile */
    .group-hover\:scale-110:hover,
    .group-hover\:scale-105:hover {
      transform: none !important;
    }
    
    /* Simplify transitions on mobile - shorter duration to reduce flicker window */
    * {
      transition-duration: 100ms !important;
    }
    
    /* Reduce shadow complexity on mobile */
    .shadow-2xl, .shadow-xl {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    
    /* Add containment for better rendering */
    section {
      contain: layout style;
    }
    
    /* Stable transforms on mobile - force GPU layer */
    .transform-gpu {
      transform: translateZ(0);
      -webkit-transform: translateZ(0);
    }
    
    /* Force hardware acceleration for all animated elements to prevent flicker */
    [class*="motion"],
    [class*="animate"] {
      transform: translateZ(0);
      -webkit-transform: translateZ(0);
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
    }
    
    /* Disable expensive hover effects on mobile */
    .hover\:shadow-\[0_0_20px_rgba\(168\,85\,247\,0\.4\)\]:hover {
      box-shadow: none;
    }
  }
  
  /* Optimize for low-power devices */
  @media (max-width: 768px) and (prefers-reduced-motion: no-preference) {
    /* Disable some animations on mobile even if user allows motion */
    .animate-bounce,
    .animate-spin {
      animation: none !important;
    }
  }

  /* Reduce motion for users who prefer it */
  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
    
    .bg-noise {
      display: none;
    }
  }

  .mesh-gradient {
    background: radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), 
                radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%);
    contain: layout style paint;
  }
  
  /* Scroll reveal classes handled by Framer Motion, but these can be fallbacks */
  .reveal-hidden {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.6s ease-out;
  }
  
  .reveal-visible {
    opacity: 1;
    transform: translateY(0);
  }
}

body {
  @apply bg-background text-foreground font-sans overflow-x-hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  scroll-behavior: smooth;
  /* Optimize scrolling performance */
  overscroll-behavior: none;
  /* Prevent text size adjustment on mobile */
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

/* Global scroll performance optimizations */
html {
  scroll-behavior: smooth;
  /* Prevent layout shifts during scroll */
  overflow-anchor: auto;
  /* Force GPU acceleration for smoother scrolling */
  -webkit-overflow-scrolling: touch;
}

/* Optimize main content sections for scroll */
main {
  contain: layout style;
  /* Prevent layout thrashing during scroll - use auto instead of scroll */
  will-change: auto;
}

section {
  contain: layout paint;
  content-visibility: auto;
  contain-intrinsic-size: auto 600px;
}

/* Optimize Framer Motion elements during scroll */
[data-framer-component-type] {
  contain: layout style;
}

/* Force hardware acceleration for motion elements but prevent over-use */
[style*="transform"] {
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* Only use transform-gpu on elements that actually animate */
.transform-gpu {
  transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  perspective: 1000px;
}

/* Optimize backdrop-filter elements - use sparingly */
[class*="backdrop-blur"] {
  transform: translateZ(0);
  isolation: isolate;
}

/* Reduce paint complexity for gradients */
[class*="bg-linear"] {
  contain: paint;
}

/* Improve tap targets on mobile */
@media (max-width: 768px) {
  button, a {
    min-height: 44px;
  }
}

h1, h2, h3, h4, h5, h6 {
  @apply font-display tracking-tight;
}

/* Text gradient utility */
.text-gradient {
  @apply bg-linear-to-r from-purple-400 via-pink-500 to-purple-600 bg-clip-text text-transparent;
}

/* Safe area insets for mobile devices with notches */
@supports (padding: max(0px)) {
  .pb-safe {
    padding-bottom: max(env(safe-area-inset-bottom), 1rem);
  }
}
